<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=3.0, user-scalable=yes">
	<link href="../res/css.css" rel="stylesheet" type="text/css" />
	<link href="../res/prism.css" rel="stylesheet" type="text/css" />
 	<script type="text/javascript" src="../res/index.js"></script>
   <title>文件操作 - boaPHP开发手册</title>
</head>
<body class="column">
	<header class="head">
		<h2>boaPHP开发手册<span>v5.5</span></h2>
		<div></div>
	</header>
	<article class="body">
		<div class="menu">
			
		</div>
		<div class="main">
			<div class="title">文件操作</div>
			<div class="content">
				<p>文件操作使用 <a href="../api/boa.file.html">file类</a>；获取文件信息使用 <a href="../api/boa.fileinfo.html">fileinfo类</a></p>

<p class="subtitle">文件或目录操作</p>
<pre><code class="language language-php">
	$file = boa::file();
	$str = $file-&gt;read(BS_VAR .'debug.txt'); // 读取文件
	$res = $file-&gt;write(BS_VAR .'debug.txt', $str, true); // 追加写入文件
	
	$path = $file-&gt;realpath('../../test.txt'); // 计算绝对路径
	$path = $file-&gt;file2url(BS_WWW .'res/logo.png'); // 文件本地路径转网页路径
	
	$arr = $file-&gt;read_dir('D:/soft', 1); // 读取目录
	$res = $file-&gt;copy_dir('D:/github/test', 'D:/test/test'); // 拷贝目录
	$res = $file-&gt;clear_dir('D:/test', true); // 清空目录
	$arr = $file-&gt;count_dir('D:/github/test', true);  // 统计目录
	$res = $file-&gt;replace_dir('D:/github/test', 'title', ''); // 目录下内容替换
	$res = $file-&gt;preg_replace_dir('D:/github/test', '/&lt;[a-z\/]+?&gt;/i', '', '/\.txt$/i'); // 使用正则搜索替换
</code></pre>

<p class="subtitle">安全模式操作</p>
<p>假设系统按用户名为每个用户分配了空间，用户文件操作均被限制在他自己的空间内，如果试图用相对路径或其他办法去越过限制，则会报错</p>
<pre><code class="language language-php">
	$file = boa::file();
	$file->cfg('safe_mode', true);
	$file->cfg('safe_path', BS_WWW ."file/$username");
	
	$arr = $file->read_dir('../../../'); // 此时会报错
</code></pre>

<p class="subtitle">读取文件信息</p>
<pre><code class="language language-php">
	$file = boa::fileinfo(BS_VAR .'debug.txt'); // 要读取的文件
	$md5 = $file-&gt;md5(); // 读取文件md5串
	$sha1 = $file-&gt;sha1(); // 读取文件sha1串
	$res = $file-&gt;mime(); // 结果：text/plain; charset=utf-8
	$res = $file-&gt;mime_type(); // 结果：text/plain
	$res = $file-&gt;charset(); // 结果：charset=utf-8
	$res = $file-&gt;ext(); // 读取文件扩展名
</code></pre>							</div>
			<div class="navigate">
				<a href="../file/70.html" class="prev">< 文件配置</a>
				<a class="menu"></a>
				<a href="../event/index.html" class="next">事件 ></a></a>
			</div>
		</div>
	</article>
	<script type="text/javascript" src="../res/menu.js"></script>
	<script type="text/javascript" src="../res/prism.js"></script>
</body>
</html>